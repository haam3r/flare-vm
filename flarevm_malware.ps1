# FLARE VM - Malware Analysis Edition 

Write-BoxstarterMessage "Malware Analysis VM, based on FLARE VM"


###############################################################################
# Configure system
###############################################################################
        
# Boxstarter optionsbj
$Boxstarter.RebootOk=$true # Allow reboots?
$Boxstarter.NoPassword=$false # Is this a machine with no login password?
$Boxstarter.AutoLogin=$true # Save my password securely and auto-login after a reboot

# Basic setup
Update-ExecutionPolicy Unrestricted
Disable-MicrosoftUpdate
Set-WindowsExplorerOptions -EnableShowProtectedOSFiles -EnableShowFileExtensions -EnableShowHiddenFilesFoldersDrives 
Set-TaskbarOptions -Size Small
Disable-BingSearch
Disable-UAC
Enable-RemoteDesktop

###############################################################################
# Install Chocolatey packages
###############################################################################

# Configure FLARE chocolatey feed
$flare = "https://www.myget.org/F/flare/api/v2"

###############################################################################
# Install packages

# Set up Chocolatey
cinst chocolatey              # Install chocolatey base package
if (Test-PendingReboot) { Invoke-Reboot }
cmd.exe /c choco sources add -n=flare -s "https://www.myget.org/F/flare/api/v2" --priority 1
cmd.exe /c choco feature enable -n allowGlobalConfirmation
cmd.exe /c choco feature enable -n allowEmptyChecksums

# Don't know what this does, so leaving disabled for now
#cinst flarevm -s $flare       # FLARE VM specific configurations

# Packages requiring reboot
cinst powershell       # PowerShell 5.1
cinst dotnet4.6.2
cinst vmware-tools

# Hex Editors
cinst fileinsight   -s $flare   # FileInsight
cinst hxd           -s $flare   # HxD
# PE
cinst peid          -s $flare   # PEiD
cinst peview        -s $flare   # PEview
# Text Editors
cinst --ignore-checksums sublimetext3            # Sublime Text 3
# Utilities
cinst checksum                     # Hash Calculator
cinst 7zip.install                 # 7-Zip
cinst wireshark.flare -s $flare    # WireShark
cinst rawcap                       # RawCap
cinst sysinternals.flare -s $flare # Sysinternals wrapper

# Stuff that runs malware
# Java
cinst javaruntime               # JRE
# Adobe Flash
cinst flashplayerplugin
cinst flashplayeractivex
cinst flashplayerppapi
# PDF
cinst adobereader
cinst foxitreader
cinst sumatrapdf
# WinRAR
cinst winrar
# Far Manager
cinst far
# Browsers
cinst ie11
cinst googlechrome
cinst firefox
# Office
cinst libreoffice
cinst officeproplus2013
